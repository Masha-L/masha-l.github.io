<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
  <meta name="description" content="{{ page.description | default: site.description }}">
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Crimson+Pro:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet">
  <!-- Styles -->
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>âœ¨</text></svg>">
  {% feed_meta %}
  {% seo %}
</head>
<body>
  <nav class="nav">
    <div class="nav-container">
      <a href="{{ '/' | relative_url }}" class="nav-logo">ML</a>
      <div class="nav-links">
        <a href="{{ '/' | relative_url }}" {% if page.url == '/' %}class="active"{% endif %}>Home</a>
        <a href="{{ '/about/' | relative_url }}" {% if page.url == '/about/' %}class="active"{% endif %}>About</a>
        <a href="{{ '/work/' | relative_url }}" {% if page.url == '/work/' %}class="active"{% endif %}>Work</a>
        <a href="{{ '/projects/' | relative_url }}" {% if page.url == '/projects/' %}class="active"{% endif %}>Projects</a>
        <a href="{{ '/blog/' | relative_url }}" {% if page.url contains '/blog' %}class="active"{% endif %}>Writing</a>
        <button class="theme-toggle" aria-label="Toggle dark mode" title="Toggle dark mode">ðŸŒ™</button>
      </div>
      <button class="nav-toggle" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>
  <main class="main">
    {{ content }}
  </main>
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-content">
        <p class="footer-tagline">Building things that matter, one line at a time.</p>
        <div class="footer-links">
          <a href="{{ '/now/' | relative_url }}">Now</a>
          <a href="{{ '/uses/' | relative_url }}">Uses</a>
          <a href="{{ '/running/' | relative_url }}">Running</a>
          <a href="https://twitter.com/ocean_ragess" target="_blank" rel="noopener">Twitter</a>
          <a href="https://github.com/Masha-L" target="_blank" rel="noopener">GitHub</a>
        </div>
      </div>
      <p class="footer-copy">Â© {{ 'now' | date: "%Y" }} Masha Lifshits Â· Built with Jekyll, hosted on GitHub Pages, designed with <a href="https://github.com/Masha-L/masha-l.github.io" style="color: inherit; text-decoration: underline;">curiosity</a></p>
    </div>
  </footer>
  <script>
    // Dark mode toggle
    const themeToggle = document.querySelector('.theme-toggle');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const savedTheme = localStorage.getItem('theme');
    
    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
      themeToggle.textContent = theme === 'dark' ? 'â˜€ï¸' : 'ðŸŒ™';
    }
    
    // Initialize theme
    if (savedTheme) {
      setTheme(savedTheme);
    } else if (prefersDark) {
      setTheme('dark');
    }
    
    themeToggle.addEventListener('click', () => {
      const current = document.documentElement.getAttribute('data-theme');
      setTheme(current === 'dark' ? 'light' : 'dark');
    });

    // Mobile nav toggle
    const toggle = document.querySelector('.nav-toggle');
    const nav = document.querySelector('.nav');
    toggle.addEventListener('click', () => nav.classList.toggle('nav-open'));
    
    // Intersection observer for fade-in animations
    const observerOptions = { threshold: 0.1, rootMargin: '0px 0px -50px 0px' };
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, observerOptions);
    document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

    // Quote rotator
    const rotator = document.getElementById('quote-rotator');
    const dotsContainer = document.getElementById('quote-dots');
    if (rotator && dotsContainer) {
      const quotes = rotator.querySelectorAll('.quote-item');
      let currentQuote = 0;
      
      // Create dots
      quotes.forEach((_, i) => {
        const dot = document.createElement('button');
        dot.className = 'quote-dot' + (i === 0 ? ' active' : '');
        dot.addEventListener('click', () => goToQuote(i));
        dotsContainer.appendChild(dot);
      });
      
      const dots = dotsContainer.querySelectorAll('.quote-dot');
      
      function goToQuote(index) {
        quotes[currentQuote].classList.remove('active');
        dots[currentQuote].classList.remove('active');
        currentQuote = index;
        quotes[currentQuote].classList.add('active');
        dots[currentQuote].classList.add('active');
      }
      
      setInterval(() => {
        goToQuote((currentQuote + 1) % quotes.length);
      }, 4000);
    }

    // Scroll reveal
    const revealObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, { threshold: 0.1 });
    document.querySelectorAll('.card, .team-card, .featured-card, .interest-card, .now-item').forEach(el => {
      el.classList.add('reveal');
      revealObserver.observe(el);
    });

    // Smooth parallax effect with requestAnimationFrame
    const heroContent = document.querySelector('.hero-content');
    const shapes = {
      s1: document.querySelectorAll('.shape-1'),
      s2: document.querySelectorAll('.shape-2'),
      s3: document.querySelectorAll('.shape-3'),
      s4: document.querySelectorAll('.shape-4'),
      s5: document.querySelectorAll('.shape-5')
    };
    
    let ticking = false;
    let lastScrollY = 0;
    let currentY = 0;
    
    function lerp(start, end, factor) {
      return start + (end - start) * factor;
    }
    
    function updateParallax() {
      // Smooth interpolation for buttery scrolling
      currentY = lerp(currentY, lastScrollY, 0.1);
      
      const scrolled = currentY;
      
      // Move shapes at different speeds
      shapes.s1.forEach(el => {
        el.style.transform = `translate3d(0, ${scrolled * -0.3}px, 0) rotate(${scrolled * 0.02}deg)`;
      });
      shapes.s2.forEach(el => {
        el.style.transform = `translate3d(0, ${scrolled * -0.15}px, 0) rotate(${scrolled * -0.03}deg)`;
      });
      shapes.s3.forEach(el => {
        el.style.transform = `translate3d(0, ${scrolled * -0.5}px, 0) rotate(${scrolled * 0.01}deg)`;
      });
      shapes.s4.forEach(el => {
        el.style.transform = `translate3d(0, ${scrolled * -0.4}px, 0) rotate(${scrolled * -0.02}deg)`;
      });
      shapes.s5.forEach(el => {
        el.style.transform = `translate3d(0, ${scrolled * -0.25}px, 0) rotate(${scrolled * 0.015}deg)`;
      });
      
      // Hero content
      if (heroContent && scrolled < 800) {
        heroContent.style.transform = `translate3d(0, ${scrolled * 0.2}px, 0)`;
        heroContent.style.opacity = Math.max(0, 1 - (scrolled * 0.0015));
      }
      
      // Keep animating if not caught up
      if (Math.abs(currentY - lastScrollY) > 0.5) {
        requestAnimationFrame(updateParallax);
      } else {
        ticking = false;
      }
    }
    
    window.addEventListener('scroll', () => {
      lastScrollY = window.pageYOffset;
      if (!ticking) {
        ticking = true;
        requestAnimationFrame(updateParallax);
      }
    }, { passive: true });
    
    // Typing effect for hero
    const typingText = document.querySelector('.typing-text');
    if (typingText) {
      const phrases = [
        'less confusing',
        'actually work',
        'not lose your data',
        'scale globally',
        'spark joy'
      ];
      let phraseIndex = 0;
      let charIndex = 0;
      let isDeleting = false;
      let isPaused = false;
      
      function type() {
        const currentPhrase = phrases[phraseIndex];
        
        if (isPaused) {
          isPaused = false;
          isDeleting = true;
          setTimeout(type, 1500);
          return;
        }
        
        if (isDeleting) {
          typingText.textContent = currentPhrase.substring(0, charIndex - 1);
          charIndex--;
          
          if (charIndex === 0) {
            isDeleting = false;
            phraseIndex = (phraseIndex + 1) % phrases.length;
            setTimeout(type, 500);
            return;
          }
        } else {
          typingText.textContent = currentPhrase.substring(0, charIndex + 1);
          charIndex++;
          
          if (charIndex === currentPhrase.length) {
            isPaused = true;
            setTimeout(type, 100);
            return;
          }
        }
        
        setTimeout(type, isDeleting ? 50 : 100);
      }
      
      setTimeout(type, 1000);
    }

    // Easter egg: Konami code
    const konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];
    let konamiIndex = 0;
    document.addEventListener('keydown', (e) => {
      if (e.key === konamiCode[konamiIndex]) {
        konamiIndex++;
        if (konamiIndex === konamiCode.length) {
          document.body.style.fontFamily = 'Comic Sans MS, cursive';
          document.querySelectorAll('*').forEach(el => {
            el.style.transition = 'transform 0.5s ease';
            el.style.transform = `rotate(${Math.random() * 6 - 3}deg)`;
          });
          setTimeout(() => alert('ðŸŽ® You found the easter egg! Refresh to restore sanity.'), 100);
          konamiIndex = 0;
        }
      } else {
        konamiIndex = 0;
      }
    });
  </script>
</body>
</html>
